# suparnatural-graphql-plugin

A Kotlin Multiplatform gradle plugin which generates type safe classes from a GraphQl schema and operations.
The generated classes are serialized using [kotlinx.serialization](https://github.com/Kotlin/kotlinx.serialization)
framework. Currently, the plugin is tested with `JVM`, `android` and `iOS`.

This plugin uses on the [suparnatural-graphql]() package. Make sure you set that up as well.

### NOTE
At the moment, this plugin relies on the [apollo-tooling](https://github.com/apollographql/apollo-tooling)
to pull `schema` and generate an intermediate `JSON` structure which can then be translated
to type safe classes.

### Do this first
1. Install [apollo-tooling](https://github.com/apollographql/apollo-tooling) using `npm install -g apollo`
2. Run the command `apollo client:codegen --target=json ...otheroptions... types.json` with other options as needed. For example
`apollo client:codegen --target=json --includes="documents/*.graphql" --localSchemaFile="schema.json" types.json`


### Setting up the plugin

1. Configure `buildscript` and apply plugin
   ```
   buildscript {
       repositories {
           maven(url="https://dl.bintray.com/suparnatural/kotlin-multiplatform")
       }
       dependencies {
           classpath("com.suparnatural.plugins:graphql:1.0.0")
       }
   }
   
   ...
   apply(plugin = "com.suparnatural.plugins.graphql")
   ```
2. Add project dependencies (adjust for multi platform)
   ```
   dependencies {
       implementation("org.jetbrains.kotlinx:kotlinx-serialization-runtime-common:0.13.0")
       implementation("org.jetbrains.kotlinx:kotlinx-serialization-runtime:0.13.0")
       implementation("suparnatural-kotlin-multiplatform:graphql:1.0.7")
       implementation("suparnatural-kotlin-multiplatform:graphql-jvm:1.0.7")
   }
   ```
3. Configure the plugin
   ```
   suparnaturalGraphQl {
       packageName = "com.your.package" // all generated classes will be placed in this package
       typesJsonFilePath = "types.json" // Path to JSON generated by apollo-tooling
       outputDirectoryPath = "src/kotlin/main" //Path to directory where classes will be generated
   }
   ```
