package com.suparnatural.core.graphql

import kotlinx.serialization.UnstableDefault
import kotlinx.serialization.json.Json
import kotlin.test.Test
import kotlin.test.assertEquals
import kotlin.test.assertNull

const val fragmentsQuery = "{\"operationName\":\"CountryCodeQuery\",\"query\":\"query CountryCodeQuery(\$code: String!) {\\n          country(code: \$code) {\\n            __typename\\n            ...CountryDetails\\n            continent {\\n              __typename\\n              ...ContinentDetails\\n            }\\n          }\\n        }\\n        fragment CountryDetails on Country {\\n          __typename\\n          code\\n          name\\n        }\\n        fragment ContinentDetails on Continent {\\n          __typename\\n          name\\n          countries {\\n            __typename\\n            ...CountryDetails\\n          }\\n        }\",\"variables\":{\"code\":\"AD\"}}"
const val simpleQuery = "{\"operationName\":\"Countries\",\"query\":\"query Countries {\\n          countries {\\n            __typename\\n            code\\n          }\\n        }\",\"variables\":{}}"
const val simpleResponse = "{\"data\":{\"countries\":[{\"__typename\":\"Country\",\"code\":\"AD\"},{\"__typename\":\"Country\",\"code\":\"AE\"},{\"__typename\":\"Country\",\"code\":\"AF\"},{\"__typename\":\"Country\",\"code\":\"AG\"},{\"__typename\":\"Country\",\"code\":\"AI\"},{\"__typename\":\"Country\",\"code\":\"AL\"},{\"__typename\":\"Country\",\"code\":\"AM\"},{\"__typename\":\"Country\",\"code\":\"AO\"},{\"__typename\":\"Country\",\"code\":\"AQ\"},{\"__typename\":\"Country\",\"code\":\"AR\"},{\"__typename\":\"Country\",\"code\":\"AS\"},{\"__typename\":\"Country\",\"code\":\"AT\"},{\"__typename\":\"Country\",\"code\":\"AU\"},{\"__typename\":\"Country\",\"code\":\"AW\"},{\"__typename\":\"Country\",\"code\":\"AX\"},{\"__typename\":\"Country\",\"code\":\"AZ\"},{\"__typename\":\"Country\",\"code\":\"BA\"},{\"__typename\":\"Country\",\"code\":\"BB\"},{\"__typename\":\"Country\",\"code\":\"BD\"},{\"__typename\":\"Country\",\"code\":\"BE\"},{\"__typename\":\"Country\",\"code\":\"BF\"},{\"__typename\":\"Country\",\"code\":\"BG\"},{\"__typename\":\"Country\",\"code\":\"BH\"},{\"__typename\":\"Country\",\"code\":\"BI\"},{\"__typename\":\"Country\",\"code\":\"BJ\"},{\"__typename\":\"Country\",\"code\":\"BL\"},{\"__typename\":\"Country\",\"code\":\"BM\"},{\"__typename\":\"Country\",\"code\":\"BN\"},{\"__typename\":\"Country\",\"code\":\"BO\"},{\"__typename\":\"Country\",\"code\":\"BQ\"},{\"__typename\":\"Country\",\"code\":\"BR\"},{\"__typename\":\"Country\",\"code\":\"BS\"},{\"__typename\":\"Country\",\"code\":\"BT\"},{\"__typename\":\"Country\",\"code\":\"BV\"},{\"__typename\":\"Country\",\"code\":\"BW\"},{\"__typename\":\"Country\",\"code\":\"BY\"},{\"__typename\":\"Country\",\"code\":\"BZ\"},{\"__typename\":\"Country\",\"code\":\"CA\"},{\"__typename\":\"Country\",\"code\":\"CC\"},{\"__typename\":\"Country\",\"code\":\"CD\"},{\"__typename\":\"Country\",\"code\":\"CF\"},{\"__typename\":\"Country\",\"code\":\"CG\"},{\"__typename\":\"Country\",\"code\":\"CH\"},{\"__typename\":\"Country\",\"code\":\"CI\"},{\"__typename\":\"Country\",\"code\":\"CK\"},{\"__typename\":\"Country\",\"code\":\"CL\"},{\"__typename\":\"Country\",\"code\":\"CM\"},{\"__typename\":\"Country\",\"code\":\"CN\"},{\"__typename\":\"Country\",\"code\":\"CO\"},{\"__typename\":\"Country\",\"code\":\"CR\"},{\"__typename\":\"Country\",\"code\":\"CU\"},{\"__typename\":\"Country\",\"code\":\"CV\"},{\"__typename\":\"Country\",\"code\":\"CW\"},{\"__typename\":\"Country\",\"code\":\"CX\"},{\"__typename\":\"Country\",\"code\":\"CY\"},{\"__typename\":\"Country\",\"code\":\"CZ\"},{\"__typename\":\"Country\",\"code\":\"DE\"},{\"__typename\":\"Country\",\"code\":\"DJ\"},{\"__typename\":\"Country\",\"code\":\"DK\"},{\"__typename\":\"Country\",\"code\":\"DM\"},{\"__typename\":\"Country\",\"code\":\"DO\"},{\"__typename\":\"Country\",\"code\":\"DZ\"},{\"__typename\":\"Country\",\"code\":\"EC\"},{\"__typename\":\"Country\",\"code\":\"EE\"},{\"__typename\":\"Country\",\"code\":\"EG\"},{\"__typename\":\"Country\",\"code\":\"EH\"},{\"__typename\":\"Country\",\"code\":\"ER\"},{\"__typename\":\"Country\",\"code\":\"ES\"},{\"__typename\":\"Country\",\"code\":\"ET\"},{\"__typename\":\"Country\",\"code\":\"FI\"},{\"__typename\":\"Country\",\"code\":\"FJ\"},{\"__typename\":\"Country\",\"code\":\"FK\"},{\"__typename\":\"Country\",\"code\":\"FM\"},{\"__typename\":\"Country\",\"code\":\"FO\"},{\"__typename\":\"Country\",\"code\":\"FR\"},{\"__typename\":\"Country\",\"code\":\"GA\"},{\"__typename\":\"Country\",\"code\":\"GB\"},{\"__typename\":\"Country\",\"code\":\"GD\"},{\"__typename\":\"Country\",\"code\":\"GE\"},{\"__typename\":\"Country\",\"code\":\"GF\"},{\"__typename\":\"Country\",\"code\":\"GG\"},{\"__typename\":\"Country\",\"code\":\"GH\"},{\"__typename\":\"Country\",\"code\":\"GI\"},{\"__typename\":\"Country\",\"code\":\"GL\"},{\"__typename\":\"Country\",\"code\":\"GM\"},{\"__typename\":\"Country\",\"code\":\"GN\"},{\"__typename\":\"Country\",\"code\":\"GP\"},{\"__typename\":\"Country\",\"code\":\"GQ\"},{\"__typename\":\"Country\",\"code\":\"GR\"},{\"__typename\":\"Country\",\"code\":\"GS\"},{\"__typename\":\"Country\",\"code\":\"GT\"},{\"__typename\":\"Country\",\"code\":\"GU\"},{\"__typename\":\"Country\",\"code\":\"GW\"},{\"__typename\":\"Country\",\"code\":\"GY\"},{\"__typename\":\"Country\",\"code\":\"HK\"},{\"__typename\":\"Country\",\"code\":\"HM\"},{\"__typename\":\"Country\",\"code\":\"HN\"},{\"__typename\":\"Country\",\"code\":\"HR\"},{\"__typename\":\"Country\",\"code\":\"HT\"},{\"__typename\":\"Country\",\"code\":\"HU\"},{\"__typename\":\"Country\",\"code\":\"ID\"},{\"__typename\":\"Country\",\"code\":\"IE\"},{\"__typename\":\"Country\",\"code\":\"IL\"},{\"__typename\":\"Country\",\"code\":\"IM\"},{\"__typename\":\"Country\",\"code\":\"IN\"},{\"__typename\":\"Country\",\"code\":\"IO\"},{\"__typename\":\"Country\",\"code\":\"IQ\"},{\"__typename\":\"Country\",\"code\":\"IR\"},{\"__typename\":\"Country\",\"code\":\"IS\"},{\"__typename\":\"Country\",\"code\":\"IT\"},{\"__typename\":\"Country\",\"code\":\"JE\"},{\"__typename\":\"Country\",\"code\":\"JM\"},{\"__typename\":\"Country\",\"code\":\"JO\"},{\"__typename\":\"Country\",\"code\":\"JP\"},{\"__typename\":\"Country\",\"code\":\"KE\"},{\"__typename\":\"Country\",\"code\":\"KG\"},{\"__typename\":\"Country\",\"code\":\"KH\"},{\"__typename\":\"Country\",\"code\":\"KI\"},{\"__typename\":\"Country\",\"code\":\"KM\"},{\"__typename\":\"Country\",\"code\":\"KN\"},{\"__typename\":\"Country\",\"code\":\"KP\"},{\"__typename\":\"Country\",\"code\":\"KR\"},{\"__typename\":\"Country\",\"code\":\"KW\"},{\"__typename\":\"Country\",\"code\":\"KY\"},{\"__typename\":\"Country\",\"code\":\"KZ\"},{\"__typename\":\"Country\",\"code\":\"LA\"},{\"__typename\":\"Country\",\"code\":\"LB\"},{\"__typename\":\"Country\",\"code\":\"LC\"},{\"__typename\":\"Country\",\"code\":\"LI\"},{\"__typename\":\"Country\",\"code\":\"LK\"},{\"__typename\":\"Country\",\"code\":\"LR\"},{\"__typename\":\"Country\",\"code\":\"LS\"},{\"__typename\":\"Country\",\"code\":\"LT\"},{\"__typename\":\"Country\",\"code\":\"LU\"},{\"__typename\":\"Country\",\"code\":\"LV\"},{\"__typename\":\"Country\",\"code\":\"LY\"},{\"__typename\":\"Country\",\"code\":\"MA\"},{\"__typename\":\"Country\",\"code\":\"MC\"},{\"__typename\":\"Country\",\"code\":\"MD\"},{\"__typename\":\"Country\",\"code\":\"ME\"},{\"__typename\":\"Country\",\"code\":\"MF\"},{\"__typename\":\"Country\",\"code\":\"MG\"},{\"__typename\":\"Country\",\"code\":\"MH\"},{\"__typename\":\"Country\",\"code\":\"MK\"},{\"__typename\":\"Country\",\"code\":\"ML\"},{\"__typename\":\"Country\",\"code\":\"MM\"},{\"__typename\":\"Country\",\"code\":\"MN\"},{\"__typename\":\"Country\",\"code\":\"MO\"},{\"__typename\":\"Country\",\"code\":\"MP\"},{\"__typename\":\"Country\",\"code\":\"MQ\"},{\"__typename\":\"Country\",\"code\":\"MR\"},{\"__typename\":\"Country\",\"code\":\"MS\"},{\"__typename\":\"Country\",\"code\":\"MT\"},{\"__typename\":\"Country\",\"code\":\"MU\"},{\"__typename\":\"Country\",\"code\":\"MV\"},{\"__typename\":\"Country\",\"code\":\"MW\"},{\"__typename\":\"Country\",\"code\":\"MX\"},{\"__typename\":\"Country\",\"code\":\"MY\"},{\"__typename\":\"Country\",\"code\":\"MZ\"},{\"__typename\":\"Country\",\"code\":\"NA\"},{\"__typename\":\"Country\",\"code\":\"NC\"},{\"__typename\":\"Country\",\"code\":\"NE\"},{\"__typename\":\"Country\",\"code\":\"NF\"},{\"__typename\":\"Country\",\"code\":\"NG\"},{\"__typename\":\"Country\",\"code\":\"NI\"},{\"__typename\":\"Country\",\"code\":\"NL\"},{\"__typename\":\"Country\",\"code\":\"NO\"},{\"__typename\":\"Country\",\"code\":\"NP\"},{\"__typename\":\"Country\",\"code\":\"NR\"},{\"__typename\":\"Country\",\"code\":\"NU\"},{\"__typename\":\"Country\",\"code\":\"NZ\"},{\"__typename\":\"Country\",\"code\":\"OM\"},{\"__typename\":\"Country\",\"code\":\"PA\"},{\"__typename\":\"Country\",\"code\":\"PE\"},{\"__typename\":\"Country\",\"code\":\"PF\"},{\"__typename\":\"Country\",\"code\":\"PG\"},{\"__typename\":\"Country\",\"code\":\"PH\"},{\"__typename\":\"Country\",\"code\":\"PK\"},{\"__typename\":\"Country\",\"code\":\"PL\"},{\"__typename\":\"Country\",\"code\":\"PM\"},{\"__typename\":\"Country\",\"code\":\"PN\"},{\"__typename\":\"Country\",\"code\":\"PR\"},{\"__typename\":\"Country\",\"code\":\"PS\"},{\"__typename\":\"Country\",\"code\":\"PT\"},{\"__typename\":\"Country\",\"code\":\"PW\"},{\"__typename\":\"Country\",\"code\":\"PY\"},{\"__typename\":\"Country\",\"code\":\"QA\"},{\"__typename\":\"Country\",\"code\":\"RE\"},{\"__typename\":\"Country\",\"code\":\"RO\"},{\"__typename\":\"Country\",\"code\":\"RS\"},{\"__typename\":\"Country\",\"code\":\"RU\"},{\"__typename\":\"Country\",\"code\":\"RW\"},{\"__typename\":\"Country\",\"code\":\"SA\"},{\"__typename\":\"Country\",\"code\":\"SB\"},{\"__typename\":\"Country\",\"code\":\"SC\"},{\"__typename\":\"Country\",\"code\":\"SD\"},{\"__typename\":\"Country\",\"code\":\"SE\"},{\"__typename\":\"Country\",\"code\":\"SG\"},{\"__typename\":\"Country\",\"code\":\"SH\"},{\"__typename\":\"Country\",\"code\":\"SI\"},{\"__typename\":\"Country\",\"code\":\"SJ\"},{\"__typename\":\"Country\",\"code\":\"SK\"},{\"__typename\":\"Country\",\"code\":\"SL\"},{\"__typename\":\"Country\",\"code\":\"SM\"},{\"__typename\":\"Country\",\"code\":\"SN\"},{\"__typename\":\"Country\",\"code\":\"SO\"},{\"__typename\":\"Country\",\"code\":\"SR\"},{\"__typename\":\"Country\",\"code\":\"SS\"},{\"__typename\":\"Country\",\"code\":\"ST\"},{\"__typename\":\"Country\",\"code\":\"SV\"},{\"__typename\":\"Country\",\"code\":\"SX\"},{\"__typename\":\"Country\",\"code\":\"SY\"},{\"__typename\":\"Country\",\"code\":\"SZ\"},{\"__typename\":\"Country\",\"code\":\"TC\"},{\"__typename\":\"Country\",\"code\":\"TD\"},{\"__typename\":\"Country\",\"code\":\"TF\"},{\"__typename\":\"Country\",\"code\":\"TG\"},{\"__typename\":\"Country\",\"code\":\"TH\"},{\"__typename\":\"Country\",\"code\":\"TJ\"},{\"__typename\":\"Country\",\"code\":\"TK\"},{\"__typename\":\"Country\",\"code\":\"TL\"},{\"__typename\":\"Country\",\"code\":\"TM\"},{\"__typename\":\"Country\",\"code\":\"TN\"},{\"__typename\":\"Country\",\"code\":\"TO\"},{\"__typename\":\"Country\",\"code\":\"TR\"},{\"__typename\":\"Country\",\"code\":\"TT\"},{\"__typename\":\"Country\",\"code\":\"TV\"},{\"__typename\":\"Country\",\"code\":\"TW\"},{\"__typename\":\"Country\",\"code\":\"TZ\"},{\"__typename\":\"Country\",\"code\":\"UA\"},{\"__typename\":\"Country\",\"code\":\"UG\"},{\"__typename\":\"Country\",\"code\":\"UM\"},{\"__typename\":\"Country\",\"code\":\"US\"},{\"__typename\":\"Country\",\"code\":\"UY\"},{\"__typename\":\"Country\",\"code\":\"UZ\"},{\"__typename\":\"Country\",\"code\":\"VA\"},{\"__typename\":\"Country\",\"code\":\"VC\"},{\"__typename\":\"Country\",\"code\":\"VE\"},{\"__typename\":\"Country\",\"code\":\"VG\"},{\"__typename\":\"Country\",\"code\":\"VI\"},{\"__typename\":\"Country\",\"code\":\"VN\"},{\"__typename\":\"Country\",\"code\":\"VU\"},{\"__typename\":\"Country\",\"code\":\"WF\"},{\"__typename\":\"Country\",\"code\":\"WS\"},{\"__typename\":\"Country\",\"code\":\"XK\"},{\"__typename\":\"Country\",\"code\":\"YE\"},{\"__typename\":\"Country\",\"code\":\"YT\"},{\"__typename\":\"Country\",\"code\":\"ZA\"},{\"__typename\":\"Country\",\"code\":\"ZM\"},{\"__typename\":\"Country\",\"code\":\"ZW\"}]}}"
const val fragmentsResponse = "{\"data\":{\"country\":{\"__typename\":\"Country\",\"code\":\"AD\",\"name\":\"Andorra\",\"continent\":{\"__typename\":\"Continent\",\"name\":\"Europe\",\"countries\":[{\"__typename\":\"Country\",\"code\":\"AD\",\"name\":\"Andorra\"},{\"__typename\":\"Country\",\"code\":\"AL\",\"name\":\"Albania\"},{\"__typename\":\"Country\",\"code\":\"AT\",\"name\":\"Austria\"},{\"__typename\":\"Country\",\"code\":\"AX\",\"name\":\"Åland\"},{\"__typename\":\"Country\",\"code\":\"BA\",\"name\":\"Bosnia and Herzegovina\"},{\"__typename\":\"Country\",\"code\":\"BE\",\"name\":\"Belgium\"},{\"__typename\":\"Country\",\"code\":\"BG\",\"name\":\"Bulgaria\"},{\"__typename\":\"Country\",\"code\":\"BY\",\"name\":\"Belarus\"},{\"__typename\":\"Country\",\"code\":\"CH\",\"name\":\"Switzerland\"},{\"__typename\":\"Country\",\"code\":\"CY\",\"name\":\"Cyprus\"},{\"__typename\":\"Country\",\"code\":\"CZ\",\"name\":\"Czech Republic\"},{\"__typename\":\"Country\",\"code\":\"DE\",\"name\":\"Germany\"},{\"__typename\":\"Country\",\"code\":\"DK\",\"name\":\"Denmark\"},{\"__typename\":\"Country\",\"code\":\"EE\",\"name\":\"Estonia\"},{\"__typename\":\"Country\",\"code\":\"ES\",\"name\":\"Spain\"},{\"__typename\":\"Country\",\"code\":\"FI\",\"name\":\"Finland\"},{\"__typename\":\"Country\",\"code\":\"FO\",\"name\":\"Faroe Islands\"},{\"__typename\":\"Country\",\"code\":\"FR\",\"name\":\"France\"},{\"__typename\":\"Country\",\"code\":\"GB\",\"name\":\"United Kingdom\"},{\"__typename\":\"Country\",\"code\":\"GG\",\"name\":\"Guernsey\"},{\"__typename\":\"Country\",\"code\":\"GI\",\"name\":\"Gibraltar\"},{\"__typename\":\"Country\",\"code\":\"GR\",\"name\":\"Greece\"},{\"__typename\":\"Country\",\"code\":\"HR\",\"name\":\"Croatia\"},{\"__typename\":\"Country\",\"code\":\"HU\",\"name\":\"Hungary\"},{\"__typename\":\"Country\",\"code\":\"IE\",\"name\":\"Ireland\"},{\"__typename\":\"Country\",\"code\":\"IM\",\"name\":\"Isle of Man\"},{\"__typename\":\"Country\",\"code\":\"IS\",\"name\":\"Iceland\"},{\"__typename\":\"Country\",\"code\":\"IT\",\"name\":\"Italy\"},{\"__typename\":\"Country\",\"code\":\"JE\",\"name\":\"Jersey\"},{\"__typename\":\"Country\",\"code\":\"LI\",\"name\":\"Liechtenstein\"},{\"__typename\":\"Country\",\"code\":\"LT\",\"name\":\"Lithuania\"},{\"__typename\":\"Country\",\"code\":\"LU\",\"name\":\"Luxembourg\"},{\"__typename\":\"Country\",\"code\":\"LV\",\"name\":\"Latvia\"},{\"__typename\":\"Country\",\"code\":\"MC\",\"name\":\"Monaco\"},{\"__typename\":\"Country\",\"code\":\"MD\",\"name\":\"Moldova\"},{\"__typename\":\"Country\",\"code\":\"ME\",\"name\":\"Montenegro\"},{\"__typename\":\"Country\",\"code\":\"MK\",\"name\":\"North Macedonia\"},{\"__typename\":\"Country\",\"code\":\"MT\",\"name\":\"Malta\"},{\"__typename\":\"Country\",\"code\":\"NL\",\"name\":\"Netherlands\"},{\"__typename\":\"Country\",\"code\":\"NO\",\"name\":\"Norway\"},{\"__typename\":\"Country\",\"code\":\"PL\",\"name\":\"Poland\"},{\"__typename\":\"Country\",\"code\":\"PT\",\"name\":\"Portugal\"},{\"__typename\":\"Country\",\"code\":\"RO\",\"name\":\"Romania\"},{\"__typename\":\"Country\",\"code\":\"RS\",\"name\":\"Serbia\"},{\"__typename\":\"Country\",\"code\":\"RU\",\"name\":\"Russia\"},{\"__typename\":\"Country\",\"code\":\"SE\",\"name\":\"Sweden\"},{\"__typename\":\"Country\",\"code\":\"SI\",\"name\":\"Slovenia\"},{\"__typename\":\"Country\",\"code\":\"SJ\",\"name\":\"Svalbard and Jan Mayen\"},{\"__typename\":\"Country\",\"code\":\"SK\",\"name\":\"Slovakia\"},{\"__typename\":\"Country\",\"code\":\"SM\",\"name\":\"San Marino\"},{\"__typename\":\"Country\",\"code\":\"UA\",\"name\":\"Ukraine\"},{\"__typename\":\"Country\",\"code\":\"VA\",\"name\":\"Vatican City\"},{\"__typename\":\"Country\",\"code\":\"XK\",\"name\":\"Kosovo\"}]}}}}"

class GraphQlTests {
    @UnstableDefault
    @Test
    fun testFragmentsOperationSerialization() {
        val operation = Operations.CountryCodeQuery("AD")
        assertEquals(fragmentsQuery, operation.jsonString)
    }

    @UnstableDefault
    @Test
    fun testSimpleQuerySerialization() {
        assertEquals(simpleQuery, Operations.Countries().jsonString)
    }

    @UnstableDefault
    @Test
    fun testSimpleResponse() {
        try {
            Json.parse(GraphQlResponse.serializer(Operations.Countries().responseSerializer), simpleResponse)
        } catch (e: Exception) {
            assertNull(e)
        }
    }

    @Test
    @UnstableDefault
    fun testFragmentsResponse() {
        try {
            Json.parse(GraphQlResponse.serializer(Operations.CountryCodeQuery("AD").responseSerializer), fragmentsResponse)
        } catch (e: Exception) {
            assertNull(e)
        }
    }
}